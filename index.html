<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cat Knight Adventure</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1e1e2f">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('Service Worker registered:', reg))
        .catch(err => console.error('Service Worker registration failed:', err));
    }
  </script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #1e1e2f;
      color: #fff;
      text-align: center;
      padding: 20px;
    }
    .map, .quiz-box, .boss-battle {
      display: none;
      max-width: 800px;
      margin: auto;
      background-color: rgba(30, 30, 47, 0.9);
      padding: 20px;
      border-radius: 15px;
    }
    .map.active, .quiz-box.active, .boss-battle.active {
      display: block;
    }
    .row {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 20px;
    }
    .zone {
      background-color: #3c3c5a;
      padding: 15px;
      border-radius: 10px;
      width: 140px;
      cursor: pointer;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      background-color: #4a90e2;
      color: white;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    .spell-btn {
      margin: 5px;
      padding: 6px 12px;
      background-color: #7e57c2;
      border: none;
      border-radius: 6px;
      color: white;
    }
    #xp-display {
      margin-top: 15px;
      font-weight: bold;
    }
    audio {
      display: none;
    }
  </style>
</head>
<body>
  <audio id="correct-sfx" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7a8b4be76e.mp3?filename=success-1-6297.mp3"></audio>
  <audio id="wrong-sfx" src="https://cdn.pixabay.com/download/audio/2022/03/11/audio_f1dd6fd7a1.mp3?filename=error-126627.mp3"></audio>
  <audio id="boss-music" loop src="https://cdn.pixabay.com/download/audio/2022/03/11/audio_a5fda2be24.mp3?filename=dark-ambient-110818.mp3"></audio>

  <div class="map active" id="map">
    <h1>🗺️ Realm of Quizzaria</h1>
    <div class="row">
      <div class="zone" onclick="startQuiz('maps')">🏔️ Mountain of Maps</div>
      <div class="zone" onclick="startQuiz('stage')">🎭 Grand Stage of Screens</div>
    </div>
    <div class="row">
      <div class="zone" onclick="startQuiz('history')">🏛️ Ruins of Time</div>
      <div class="zone" onclick="startQuiz('sports')">🏟️ Arena of Motion</div>
    </div>
    <div class="row">
      <div class="zone" onclick="startQuiz('daily')">🔮 Crystal Spire</div>
      <div class="zone" onclick="startBossBattle()">🌩️ Castle of Oblivion</div>
    </div>
    <div id="xp-display">XP: 0</div>
  </div>

  <div class="quiz-box" id="quiz">
    <h2 id="quiz-title">Quiz</h2>
    <p id="question"></p>
    <div id="answers"></div>
    <div>
      <button class="spell-btn" onclick="useHint()">🪄 Hint</button>
      <button class="spell-btn" onclick="useRemove()">💥 Remove One</button>
    </div>
    <p id="feedback"></p>
    <button class="btn" onclick="nextQuestion()">Next</button>
  </div>

  <div class="boss-battle" id="boss">
    <h2>⚔️ Battle: Shadow Sage</h2>
    <p id="boss-question"></p>
    <div id="boss-answers"></div>
    <p id="boss-feedback"></p>
    <p id="boss-progress"></p>
    <button class="btn" onclick="nextBossQuestion()">Next</button>
  </div>

  <script>
    let xp = 0;
    let currentQ = 0;
    let quizData = [
      { q: "How many continents are there?", a: "7", o: ["5", "6", "7", "8"], f: "They are: Asia, Africa, North America, South America, Antarctica, Europe, Australia." },
      { q: "Who wrote '1984'?", a: "George Orwell", o: ["Aldous Huxley", "George Orwell", "Ray Bradbury", "J.K. Rowling"], f: "George Orwell also wrote 'Animal Farm'." }
    ];

    function startQuiz(subject) {
      document.getElementById('map').classList.remove('active');
      document.getElementById('quiz').classList.add('active');
      currentQ = 0;
      showQuestion();
    }

    function showQuestion() {
      const q = quizData[currentQ];
      document.getElementById('quiz-title').innerText = `Quiz Time!`;
      document.getElementById('question').innerText = q.q;
      const ansDiv = document.getElementById('answers');
      ansDiv.innerHTML = '';
      document.getElementById('feedback').innerText = '';
      q.o.forEach(option => {
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.innerText = option;
        btn.onclick = () => {
          if (option === q.a) {
            document.getElementById('feedback').innerText = `✅ Correct! ${q.f}`;
            document.getElementById('correct-sfx').play();
            xp += 10;
            document.getElementById('xp-display').innerText = `XP: ${xp}`;
          } else {
            document.getElementById('feedback').innerText = `❌ Wrong! ${q.f}`;
            document.getElementById('wrong-sfx').play();
          }
        };
        ansDiv.appendChild(btn);
      });
    }

    function nextQuestion() {
      currentQ++;
      if (currentQ < quizData.length) {
        showQuestion();
      } else {
        document.getElementById('quiz').classList.remove('active');
        document.getElementById('map').classList.add('active');
      }
    }

    function startBossBattle() {
      document.getElementById('map').classList.remove('active');
      document.getElementById('boss').classList.add('active');
      document.getElementById('boss-music').play();
      bossIndex = 0;
      correctBossAnswers = 0;
      showBossQuestion();
    }

    const bossData = [
      { q: "What is the capital of Egypt?", a: "Cairo", o: ["Alexandria", "Giza", "Cairo", "Luxor"] },
      { q: "Who painted the Mona Lisa?", a: "Leonardo da Vinci", o: ["Michelangelo", "Raphael", "Leonardo da Vinci", "Donatello"] },
      { q: "Largest planet in our solar system?", a: "Jupiter", o: ["Earth", "Saturn", "Jupiter", "Mars"] },
      { q: "Year WWII ended?", a: "1945", o: ["1939", "1942", "1945", "1950"] },
      { q: "Which language runs in browsers?", a: "JavaScript", o: ["Python", "HTML", "JavaScript", "C++"] }
    ];

    let bossIndex = 0;
    let correctBossAnswers = 0;

    function showBossQuestion() {
      const q = bossData[bossIndex];
      document.getElementById('boss-question').innerText = q.q;
      document.getElementById('boss-progress').innerText = `Question ${bossIndex + 1} of 5`;
      const ansDiv = document.getElementById('boss-answers');
      ansDiv.innerHTML = '';
      document.getElementById('boss-feedback').innerText = '';
      q.o.forEach(option => {
        const btn = document.createElement('button');
        btn.className = 'btn';
        btn.innerText = option;
        btn.onclick = () => {
          if (option === q.a) {
            document.getElementById('boss-feedback').innerText = "✅ Correct!";
            document.getElementById('correct-sfx').play();
            correctBossAnswers++;
          } else {
            document.getElementById('boss-feedback').innerText = "❌ Wrong! Restarting...";
            document.getElementById('wrong-sfx').play();
            setTimeout(() => startBossBattle(), 1500);
            return;
          }
        };
        ansDiv.appendChild(btn);
      });
    }

    function nextBossQuestion() {
      bossIndex++;
      if (bossIndex >= bossData.length) {
        alert("🎉 You defeated the Shadow Sage and earned the Wizard Hat!");
        document.getElementById('boss').classList.remove('active');
        document.getElementById('map').classList.add('active');
        document.getElementById('boss-music').pause();
        document.getElementById('boss-music').currentTime = 0;
      } else {
        showBossQuestion();
      }
    }
  </script>
</body>
</html>
